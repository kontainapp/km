# Contains:
# 1. All the long running tests and tests that run in normal CI.
# 2. All the validation the requires a refresh k8s cluster.

steps:
  - bash: make -C tests test-all-withk8s
    displayName: KM tests - run on Kubernetes
    timeoutInMinutes: 15

  - bash: make -C tests coverage-withk8s
    displayName: KM tests with coverage - run on Kubernetes
    timeoutInMinutes: 15

  - bash: make -C payloads test-all-withk8s
    displayName: Payloads tests - run on Kubernetes
    timeoutInMinutes: 60

  - bash: make -C payloads validate-runenv-withk8s
    displayName: payloads runenv validation - run on Kubernetes
    timeoutInMinutes: 5

# keep this here as an EXPLICIT reminder to get releases back in the build
#   - bash: make edge-release GITHUB_TOKEN=$(GITHUB_TOKEN)
#     displayName: Kick off release pipeline to build and upload release v0.1-edge
#     timeoutInMinutes: 5
