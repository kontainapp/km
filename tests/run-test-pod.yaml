#
# A helper for manually running test container as a pod in Kubernetes
# USER and BUILD_ID need to be defined (see ./Makefile)
# The pod is configured to just sleep for an hours... the idea is that
# a shell will be execed in the pod, manually
#
apiVersion: v1
kind: Pod
metadata:
  name: USER-test-SUFFIX
spec:
  securityContext:
    runAsUser: 0
  containers:
    - name: USER-test-SUFFIX
      image: kontainkubecr.azurecr.io/test-km-fedora:IMAGE_VERSION
      command: ["sleep", "3600"]
      securityContext:
        allowPrivilegeEscalation: false
      resources:
        requests:
          devices.kubevirt.io/kvm: "1"
          cpu: "250m"
        limits:
          devices.kubevirt.io/kvm: "1"
          cpu: "1"
